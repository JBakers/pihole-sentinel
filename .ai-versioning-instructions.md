# AI Assistant - Version Management Instructions

**COPY THIS TO YOUR AI ASSISTANT TO ENFORCE VERSION MANAGEMENT**

---

## ‚ö†Ô∏è MANDATORY RULES - MUST FOLLOW FOR EVERY COMMIT

### Critical: Version Management (NON-NEGOTIABLE)

**üö® THESE RULES MUST BE FOLLOWED FOR EVERY CODE CHANGE üö®**

#### Version Update Requirements

**BEFORE making ANY commit, you MUST:**

1. ‚úÖ **Update `VERSION` file** with new semantic version
2. ‚úÖ **Update `CHANGELOG.md`** with detailed entry
   - Add entry under appropriate version section
   - Use categories: New, Improved, Fixed, Security, Documentation
   - Include specific details of what changed
3. ‚úÖ **Update `CLAUDE.md` header** (lines 3-4) with new version and date

---

### Semantic Versioning (SemVer 2.0.0)

**This project adheres to [Semantic Versioning 2.0.0](https://semver.org/).**

Given a version number **MAJOR.MINOR.PATCH**, increment:

1. **MAJOR** version when you make incompatible API changes or breaking changes
   - Example: Changing configuration file format without backward compatibility
   - Example: Removing or renaming required environment variables
   - Example: Changing CLI arguments or options

2. **MINOR** version when you add functionality in a backward compatible manner
   - Example: Adding new features
   - Example: Adding new optional configuration options
   - Example: Deprecating functionality (but still working)

3. **PATCH** version when you make backward compatible bug fixes
   - Example: Fixing bugs without changing functionality
   - Example: Performance improvements
   - Example: Security patches that don't change behavior

**Pre-Release Versions (Optional):**
- Format: `MAJOR.MINOR.PATCH-identifier.number`
- Examples: `1.0.0-alpha.1`, `1.0.0-beta.1`, `1.0.0-rc.1`
- Pre-release versions are considered unstable
- They sort before the normal version (e.g., `1.0.0-alpha < 1.0.0`)

**Quick Decision Tree:**
- üî¥ Breaking change? ‚Üí Bump MAJOR
- üü° New feature (backward compatible)? ‚Üí Bump MINOR
- üü¢ Bug fix? ‚Üí Bump PATCH
- ‚ö™ Documentation only? ‚Üí No version change needed

**Examples:**
```
1.0.0       ‚Üí First stable release
1.0.1       ‚Üí Bug fix
1.1.0       ‚Üí New feature (backward compatible)
2.0.0       ‚Üí Breaking change
1.0.0-beta  ‚Üí Beta pre-release
```

---

### Pre-Commit Verification Checklist

**AI Assistant: You MUST verify ALL items before executing `git commit`:**

- [ ] `VERSION` file updated (if code changed)
- [ ] `CHANGELOG.md` has new entry for this version (if code changed)
- [ ] `CLAUDE.md` header updated with version and date (if code changed)
- [ ] No `print()` statements in Python code (use `logger.*()`)
- [ ] No hardcoded credentials or secrets
- [ ] All bash scripts use LF line endings (not CRLF)
- [ ] Commit message follows required format

---

### Commit Message Format (REQUIRED)

```
type: brief description (50 chars max)

Longer explanation if needed.
What changed and why.

Version: X.Y.Z
```

**Valid types:** `feat`, `fix`, `docs`, `style`, `refactor`, `test`, `chore`, `security`

**Examples:**
- `feat: add support for custom notification endpoints`
- `fix: retry VIP detection on ARP table population failure`
- `docs: update README with installation instructions`
- `chore: bump dependency versions for security patches`

---

### AI Assistant Failure Protocol

**If you (AI assistant) make a commit without updating VERSION and CHANGELOG.md:**
- ‚ùå You have FAILED this task
- ‚ùå The commit is INVALID
- ‚úÖ You must immediately create a follow-up commit fixing the version
- ‚úÖ Apologize to the user and explain what was missed

**No exceptions. No shortcuts. These rules apply to EVERY commit.**

---

## Git Pre-Commit Hook Setup

### Installation

The repository includes a pre-commit hook that enforces these rules automatically.

**Install the hook:**

```bash
# Option 1: Copy hook to .git/hooks (Recommended)
cp .githooks/pre-commit .git/hooks/pre-commit
chmod +x .git/hooks/pre-commit

# Option 2: Configure git to use .githooks directory
git config core.hooksPath .githooks
```

### What the Hook Enforces

- ‚úÖ VERSION file must be updated for code changes
- ‚úÖ CHANGELOG.md must be updated for code changes
- ‚úÖ No `print()` statements in Python files
- ‚úÖ No CRLF line endings in bash scripts
- ‚úÖ Allows documentation-only changes without version updates

### Testing the Hook

```bash
# Make a test change
echo "# test" >> some-file.py
git add some-file.py

# Try to commit without updating VERSION (should fail)
git commit -m "test: should fail"

# Expected output:
# ‚úó ERROR: VERSION file not updated!
# ‚úó ERROR: CHANGELOG.md not updated!
```

---

## Common Mistakes to Avoid

1. **Committing code changes without updating VERSION**
   - ALWAYS update VERSION for code changes
   - Documentation-only changes don't require version updates

2. **Forgetting to update CHANGELOG.md**
   - Every version bump needs a CHANGELOG entry
   - Be specific about what changed

3. **Using wrong version increment**
   - Bug fix? ‚Üí PATCH (0.0.X)
   - New feature? ‚Üí MINOR (0.X.0)
   - Breaking change? ‚Üí MAJOR (X.0.0)

4. **Skipping CLAUDE.md header update**
   - Lines 3-4 must match VERSION file
   - Update the date to current date

---

## Example Workflow

```bash
# 1. Make your code changes
vim dashboard/monitor.py

# 2. Update VERSION file
echo "1.2.3" > VERSION

# 3. Update CHANGELOG.md
vim CHANGELOG.md
# Add entry:
# ## [1.2.3] - 2025-11-16
# ### Fixed
# - Improved error handling in VIP detection

# 4. Update CLAUDE.md header
vim CLAUDE.md
# Line 3: **Last Updated:** 2025-11-16
# Line 4: **Version:** 1.2.3

# 5. Commit with proper message
git add .
git commit -m "fix: improve error handling in VIP detection

Added retry logic for VIP detection failures.

Version: 1.2.3"
```

---

**Remember: The git pre-commit hook will catch these mistakes, but you should follow these rules proactively!**
